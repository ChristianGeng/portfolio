From awrench@articulateinstruments.com Thu Jan  3 15:11:32 2008
Date: Thu, 3 Jan 2008 14:10:22 -0000
From: Alan Wrench <awrench@articulateinstruments.com>
To: Phil Hoole <hoole@phonetik.uni-muenchen.de>
Subject: RE: EPG/Ultrasound

Hi Phil,
	Happy new year!
I'm back today after a relaxing break. Just starting to pick up the pieces
left from before Christmas. A small sprinkling of snow this morning. Just a
small taste of what I understand you've been having in continental Europe.

I've had to go back and have a look at the code to see what should be
happening. Your observations tally with what the firmware is programmed to
provide.

Both 'R' and 'T' commands prime the scan process to output a marked palate
on the next scan. The 'T' command also primes the scan process to stop after
the next scan then check every 7ms for a 'D','T','R' or a 'U' command. This
means with a 'T' command you get a marked palate and then no palates for the
duration of the tone. There will be a further delay of up to 7ms before the
scan process is initiated and then 3ms for the scan to complete.
Now that I come to look at it closely, the 'T' command seems rather clumsy.
I'm not sure why we can't poll more often than 7ms.

The 'R' command doesn't initiate the internal tone but I guess you're using
the matlab code to put a marker on the audio track for synchronisation.

I'm not sure why the RURU does not work. Assuming you have called the 'E'
command first, the scan process will be in progress when the SPI receives
the 'R' command. As a worst case it could take up to 5ms (the scan period)
before it processes the command and initiates the beep. Then there will be a
further 5ms before it can process the 'U' command. If you are unlucky and
the 'R''U' sequence is less than 10ms apart then I guess the two commands
could cancel out.

I've attached a flow diagram of this part of the firmware. I hope this
helps.

Best wishes

Alan

Alan Wrench
Articulate Instruments Ltd
Queen Margaret Campus,
Queen Margaret University Drive
Musselburgh, East Lothian,
EH21 6UU    UK
www.articulateinstruments.com
Tel:+44 (0)131 474 0000





> -----Original Message-----
> From: Phil Hoole [mailto:hoole@phonetik.uni-muenchen.de]
> Sent: 03 January 2008 08:41
> To: Alan Wrench
> Subject: RE: EPG/Ultrasound
>
>
> Hi Alan
>
> Hope you successfully negotiated Hogmanay into 2008.
>
> While teaching shut down over Christmas I had the chance to work a bit
> more on EPG data acquisition with matlab.
>
> Basically it seems to work fine, I just have a couple of queries
> about the
> commands:
>
> (I append below the original information you sent me)
>
> It seems that the first frame marker is set in the frame
> immediately after
> the 'T' of 'R' is performed, rather than in the frame after they
> are reset
> with the 'U' command
> (in practice I always use 'R' rather than 'T', as 'T' suppresses the scan
> signal).
>
> There's no problem with this; I just wanted to check that this is the
> behaviour that should be occurring.
>
> A minor query: Is there any restriction on how fast commands can be sent
> to the EPG device? I tried to get 2 short beeps by sending a string of
> 'RURU', but this didn't work, whereas waiting 20ms or so between sending
> each character was fine.
>
> All the best
>
> Phil
>
>
> On Fri, 16 Mar 2007, Alan Wrench wrote:
>
> > Hi Phil,
> > 	Here are the RS232 commands.
> >
> > '*             "A" Select 100Hz scan rate                       *
> > '*             "B" Select 200Hz scan rate                       *
> > '*             "C" Start scan preceded by 500mS tone            *
> > '*              First frame marker on first frame               *
> > '*             "D" Stop scan  C or scan E                       *
> > '*             "E" Start Scan with no sync tone                 *
> > '*             *T" Start Buzzer and tone during E scan          *
> > '*             "S" Start Buzzer alone                           *
> > '*             "R" Start buzzer at beginning of next frame      *
> > '*                 during  E scan                               *
> > '*             "U" Stop Buzzer and tone at end of current frame *
> > '*             First Frame Marker when T or R stopped by U      *
> > '*             Use "D" to terminate "E" scan                    *
> >
> > send A and E then T and U an finally D
> >
> > Data returned from the WinEPG is nine bytes: AA followed by
> bytes in reverse
> > row order i.e. first row last
> >
> > The WinEPG system now comes with a usb connector rather than a
> serial port
> > connector.
> >
> > I think the university of Queensland had a go at writing their
> own Matlab
> > interface a few years ago but I never heard whether they were
> successful.
> >
> > I must find time to put more information about my products on
> the website.
> > The main thing I need to do is to get a demo version of the new
> software on
> > there. It's not something you guys need as you've got lots of technical
> > expertise but it does make it easy to do very powerful analysis of
> > articulatory data without needing to know how to program scripts of any
> > kind.
> >
> > Cheers
> >
> > Alan
> >
> > -----Original Message-----
> > From: Phil Hoole [mailto:hoole@phonetik.uni-muenchen.de]
> > Sent: 16 March 2007 12:02
> > To: Alan Wrench
> > Subject: RE: EPG/Ultrasound
> >
> >
> > Hi Alan
> >
> > I'll try and get an order out on MOnday.
> >
> > Is there any documentation you can send me in advance, especially on
> > handling the serial interface.
> >
> > I will have a first crack at it using matlab (which could even make it
> > platform-independent), as it has quite good support for serial
> interfaces.
> >
> > Do you have any experience with USB-Serial convertors (or recommend one)
> > as we almost certianly want to use it with new notebooks
> without a serial
> > connector?
> >
> > Phil
> >
> > =====================================================
> > Phil Hoole
> >
> > Institut fuer Phonetik und Sprachverarbeitung
> > Ludwig-Maximilians-Universitaet Muenchen
> > Schellingstr. 3
> > D - 80799 Munich
> > Germany
> >
> > Email: hoole@phonetik.uni-muenchen.de
> > Web:   http://www.phonetik.uni-muenchen.de/~hoole
> >
> > Tel: + 49 89 2180 3149
> > Fax: + 49 89 2180 5790
> >
>

    [ Part 2, Image/JPEG  75KB. ]
    [ Unable to print this part. ]

