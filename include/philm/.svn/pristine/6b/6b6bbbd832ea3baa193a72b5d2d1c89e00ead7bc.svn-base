function prompter_repeat(mycmd);
% function prompter_repeat(mycmd);

P=prompter_gmaind;

istim=P.istim;
if istim==1
    disp('Repeat not possible before first stimulus');
    return;
end;

S=prompter_gstimd;

ps=S.ps;
cs=S.cs;

disp('Repeating!!');
P.repeatstr=P.repeat4log;
P.logtext_trial=[P.logtext_trial P.rubbish4log];   
%if stimstack is used this will need modifying
istim=istim-1;
P.istim=istim;
if mycmd=='R'
    irun=P.irun;
    
    irun=irun-1;
    disp('Re-using previous trial number');
P.logtext_sup=[P.logtext_sup '<Re-using previous trial number>' crlf];
    P.irun=irun;
end;
prompter_showmsg(P.repeatmsg);

disp('hit any key to continue');
pause
prompter_showg(ps{istim});
prompter_dotrafficlights('stop');
prompter_showstim2investigator(istim);            
prompter_smaind(P);
