function [filename,declevel,S]=findtdms_chinfo(id)
% FINDTDMS_CHINFO get info on channel in tdms file
% function [filename,declevel,S]=findtdms_chinfo(id)
% findtdms_chinfo Version 12.11.2012
%
%   Description
%       Mainly for use within converttdms_ph

longname=id.long_name;
filename=longname;
filename=strrep(filename,' - ','_');
filename=strrep(filename,'All Data','');
filename=strrep(filename,'.','');
filename=strrep(filename,':','');
filename=strrep(filename,' ','_');
ipi=findstr('/',filename);
descriptor=filename((ipi+1):end);
filename=strrep(filename,'/','_');
filename=strrep(filename,'__','_');

S.descriptor=descriptor;

%also need info to use as unit, samplerate

unit='';
samplerate=NaN;

declevel=-1;
mychan='';
f1=fieldnames(id);

nf1=length(f1);

for if1=1:nf1
    tf1=id.(f1{if1});
    if isstruct(tf1)
        if isfield(tf1,'name')
            myname=tf1.name;
            if strcmp(myname,'DecimationLevel')
                declevel=tf1.value;
            end;
            if strcmp(myname,'NI_ChannelName')
                ccc=tf1.value;
                mychan=char(ccc);
            end;
            if strcmp(myname,'wf_increment')
                samplerate=1./tf1.value;
            end;
            if strcmp(myname,'unit_string')     %alternative: NI_UnitDescription
                ccc=tf1.value;
                unit=char(ccc);
            end;
        end;
    end;
end;
S.NI_ChannelName=mychan;
S.unit=unit;
S.samplerate=samplerate;
